# ç¼–è¾‘å™¨è®¾ç½® API

## æ¦‚è¿°

ç¼–è¾‘å™¨è®¾ç½®ç®¡ç†æä¾›ç”¨æˆ·ä¸ªæ€§åŒ–çš„ç¼–è¾‘å™¨é…ç½®åŠŸèƒ½ï¼ŒåŒ…æ‹¬å­—ä½“ã€ä¸»é¢˜ã€è¡Œè·ã€æ®µè½æ ¼å¼ç­‰è®¾ç½®ã€‚

**åŸºç¡€è·¯å¾„**: `/api/v1/editor-settings`

---

## 1. è·å–ç¼–è¾‘å™¨è®¾ç½®

### æ¥å£ä¿¡æ¯

- **è·¯å¾„**: `GET /editor-settings`
- **æƒé™**: `editor-settings:view`ï¼ˆæ™®é€šç”¨æˆ·ï¼‰
- **æè¿°**: è·å–å½“å‰ç”¨æˆ·çš„ç¼–è¾‘å™¨è®¾ç½®ï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰è®¾ç½®åˆ™è¿”å›é»˜è®¤é…ç½®

### å“åº”ç¤ºä¾‹

```json
{
  "id": 1,
  "userId": 123,
  "fontFamily": "Microsoft YaHei, PingFang SC, SimSun, sans-serif",
  "fontSize": 16,
  "lineHeight": 1.8,
  "theme": "auto",
  "paragraphIndent": 2,
  "paragraphSpacing": 1,
  "autoSave": true,
  "autoSaveInterval": 30,
  "showWordCount": true,
  "backgroundColor": "#F5F3E8",
  "backgroundImage": null,
  "createdAt": "2025-11-02T10:00:00.000Z",
  "updatedAt": "2025-11-02T10:00:00.000Z"
}
```

### å­—æ®µè¯´æ˜

| å­—æ®µ             | ç±»å‹    | è¯´æ˜                                                           |
| ---------------- | ------- | -------------------------------------------------------------- |
| id               | number  | è®¾ç½® ID                                                        |
| userId           | number  | ç”¨æˆ· ID                                                        |
| fontFamily       | string  | å­—ä½“ï¼ˆé»˜è®¤ï¼šMicrosoft YaHei, PingFang SC, SimSun, sans-serifï¼‰ |
| fontSize         | number  | å­—ä½“å¤§å°ï¼ˆåƒç´ ï¼ŒèŒƒå›´ï¼š12-32ï¼Œé»˜è®¤ï¼š16ï¼‰                        |
| lineHeight       | number  | è¡Œè·ï¼ˆå€æ•°ï¼ŒèŒƒå›´ï¼š1.0-3.0ï¼Œé»˜è®¤ï¼š1.8ï¼‰                         |
| theme            | string  | ç¼–è¾‘å™¨ä¸»é¢˜ï¼ˆlight/dark/autoï¼Œé»˜è®¤ï¼šautoï¼‰                      |
| paragraphIndent  | number  | æ®µé¦–ç©ºæ ¼æ•°ï¼ˆå…¨è§’ç©ºæ ¼ï¼ŒèŒƒå›´ï¼š0-10ï¼Œé»˜è®¤ï¼š2ï¼‰                    |
| paragraphSpacing | number  | æ®µé—´ç©ºè¡Œæ•°ï¼ˆèŒƒå›´ï¼š0-5ï¼Œé»˜è®¤ï¼š1ï¼‰                               |
| autoSave         | boolean | æ˜¯å¦å¯ç”¨è‡ªåŠ¨ä¿å­˜ï¼ˆé»˜è®¤ï¼štrueï¼‰                                 |
| autoSaveInterval | number  | è‡ªåŠ¨ä¿å­˜é—´éš”ï¼ˆç§’ï¼ŒèŒƒå›´ï¼š10-300ï¼Œé»˜è®¤ï¼š30ï¼‰                     |
| showWordCount    | boolean | æ˜¯å¦æ˜¾ç¤ºå­—æ•°ç»Ÿè®¡ï¼ˆé»˜è®¤ï¼štrueï¼‰                                 |
| backgroundColor  | string  | èƒŒæ™¯é¢œè‰²ï¼ˆCSS é¢œè‰²å€¼ï¼Œå¦‚ï¼š#F5F3E8ï¼Œé»˜è®¤ï¼šnullï¼‰                |
| backgroundImage  | string  | èƒŒæ™¯å›¾ç‰‡è·¯å¾„ï¼ˆä¼˜å…ˆäºèƒŒæ™¯é¢œè‰²ï¼Œé»˜è®¤ï¼šnullï¼‰                     |
| createdAt        | string  | åˆ›å»ºæ—¶é—´                                                       |
| updatedAt        | string  | æ›´æ–°æ—¶é—´                                                       |

---

## 2. åˆ›å»º/ä¿å­˜ç¼–è¾‘å™¨è®¾ç½®

### æ¥å£ä¿¡æ¯

- **è·¯å¾„**: `POST /editor-settings`
- **æƒé™**: `editor-settings:update`ï¼ˆæ™®é€šç”¨æˆ·ï¼‰
- **æè¿°**: åˆ›å»ºæˆ–ä¿å­˜ç”¨æˆ·çš„ç¼–è¾‘å™¨è®¾ç½®

### è¯·æ±‚ä½“

```json
{
  "fontFamily": "Microsoft YaHei, sans-serif",
  "fontSize": 18,
  "lineHeight": 2.0,
  "theme": "dark",
  "paragraphIndent": 2,
  "paragraphSpacing": 1,
  "autoSave": true,
  "autoSaveInterval": 60,
  "showWordCount": true
}
```

### è¯·æ±‚å‚æ•°

| å‚æ•°             | ç±»å‹    | å¿…å¡« | è¯´æ˜                      |
| ---------------- | ------- | ---- | ------------------------- |
| fontFamily       | string  | å¦   | å­—ä½“                      |
| fontSize         | number  | å¦   | å­—ä½“å¤§å°ï¼ˆ12-32ï¼‰         |
| lineHeight       | number  | å¦   | è¡Œè·ï¼ˆ1.0-3.0ï¼‰           |
| theme            | string  | å¦   | ä¸»é¢˜ï¼ˆlight/dark/autoï¼‰   |
| paragraphIndent  | number  | å¦   | æ®µé¦–ç©ºæ ¼æ•°ï¼ˆ0-10ï¼‰        |
| paragraphSpacing | number  | å¦   | æ®µé—´ç©ºè¡Œæ•°ï¼ˆ0-5ï¼‰         |
| autoSave         | boolean | å¦   | æ˜¯å¦è‡ªåŠ¨ä¿å­˜              |
| autoSaveInterval | number  | å¦   | è‡ªåŠ¨ä¿å­˜é—´éš”ï¼ˆ10-300 ç§’ï¼‰ |
| showWordCount    | boolean | å¦   | æ˜¯å¦æ˜¾ç¤ºå­—æ•°ç»Ÿè®¡          |

### å“åº”ç¤ºä¾‹

```json
{
  "id": 1,
  "userId": 123,
  "fontFamily": "Microsoft YaHei, sans-serif",
  "fontSize": 18,
  "lineHeight": 2.0,
  "theme": "dark",
  "paragraphIndent": 2,
  "paragraphSpacing": 1,
  "autoSave": true,
  "autoSaveInterval": 60,
  "showWordCount": true,
  "createdAt": "2025-11-02T10:00:00.000Z",
  "updatedAt": "2025-11-02T10:05:00.000Z"
}
```

---

## 3. æ›´æ–°ç¼–è¾‘å™¨è®¾ç½®

### æ¥å£ä¿¡æ¯

- **è·¯å¾„**: `PUT /editor-settings`
- **æƒé™**: `editor-settings:update`ï¼ˆæ™®é€šç”¨æˆ·ï¼‰
- **æè¿°**: æ›´æ–°å½“å‰ç”¨æˆ·çš„ç¼–è¾‘å™¨è®¾ç½®

### è¯·æ±‚ä½“

```json
{
  "fontSize": 20,
  "theme": "light"
}
```

### è¯·æ±‚å‚æ•°

æ‰€æœ‰å‚æ•°å¯é€‰ï¼Œåªæ›´æ–°æä¾›çš„å­—æ®µã€‚å‚æ•°è¯´æ˜åŒ"åˆ›å»º/ä¿å­˜ç¼–è¾‘å™¨è®¾ç½®"æ¥å£ã€‚

### å“åº”ç¤ºä¾‹

```json
{
  "id": 1,
  "userId": 123,
  "fontFamily": "Microsoft YaHei, sans-serif",
  "fontSize": 20,
  "lineHeight": 2.0,
  "theme": "light",
  "paragraphIndent": 2,
  "paragraphSpacing": 1,
  "autoSave": true,
  "autoSaveInterval": 60,
  "showWordCount": true,
  "createdAt": "2025-11-02T10:00:00.000Z",
  "updatedAt": "2025-11-02T10:10:00.000Z"
}
```

---

## 4. é‡ç½®ä¸ºé»˜è®¤è®¾ç½®

### æ¥å£ä¿¡æ¯

- **è·¯å¾„**: `POST /editor-settings/reset`
- **æƒé™**: `editor-settings:reset`ï¼ˆæ™®é€šç”¨æˆ·ï¼‰
- **æè¿°**: é‡ç½®å½“å‰ç”¨æˆ·çš„ç¼–è¾‘å™¨è®¾ç½®ä¸ºç³»ç»Ÿé»˜è®¤é…ç½®

### è¯·æ±‚ä½“

æ— éœ€è¯·æ±‚ä½“

### å“åº”ç¤ºä¾‹

```json
{
  "id": 2,
  "userId": 123,
  "fontFamily": "Microsoft YaHei, PingFang SC, SimSun, sans-serif",
  "fontSize": 16,
  "lineHeight": 1.8,
  "theme": "auto",
  "paragraphIndent": 2,
  "paragraphSpacing": 1,
  "autoSave": true,
  "autoSaveInterval": 30,
  "showWordCount": true,
  "createdAt": "2025-11-02T10:15:00.000Z",
  "updatedAt": "2025-11-02T10:15:00.000Z"
}
```

---

## 5. åˆ é™¤ç¼–è¾‘å™¨è®¾ç½®

### æ¥å£ä¿¡æ¯

- **è·¯å¾„**: `DELETE /editor-settings`
- **æƒé™**: `editor-settings:update`ï¼ˆæ™®é€šç”¨æˆ·ï¼‰
- **æè¿°**: åˆ é™¤å½“å‰ç”¨æˆ·çš„ç¼–è¾‘å™¨è®¾ç½®

### å“åº”ç¤ºä¾‹

```json
{
  "message": "ç¼–è¾‘å™¨è®¾ç½®å·²åˆ é™¤"
}
```

---

## 6. ä¸Šä¼ ç¼–è¾‘å™¨èƒŒæ™¯å›¾ ğŸ†•

### æ¥å£ä¿¡æ¯

- **è·¯å¾„**: `POST /editor-settings/upload-background`
- **æƒé™**: `editor-settings:update`ï¼ˆæ™®é€šç”¨æˆ·ï¼‰
- **æè¿°**: ä¸Šä¼ ç¼–è¾‘å™¨èƒŒæ™¯å›¾ç‰‡
- **Content-Type**: `multipart/form-data`

### è¯·æ±‚å‚æ•°

| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜                               |
| ---- | ---- | ---- | ---------------------------------- |
| file | File | æ˜¯   | å›¾ç‰‡æ–‡ä»¶ï¼ˆJPG/PNG/WebPï¼Œæœ€å¤§ 5MBï¼‰ |

### å“åº”ç¤ºä¾‹

```json
{
  "backgroundImage": "editor-backgrounds/123-1699999999.jpg",
  "url": "http://your-domain/uploads/editor-backgrounds/123-1699999999.jpg"
}
```

### é™åˆ¶è¯´æ˜

- æ”¯æŒæ ¼å¼ï¼šJPG, PNG, WebP
- æ–‡ä»¶å¤§å°ï¼šæœ€å¤§ 5MB
- æ¯ä¸ªç”¨æˆ·åªèƒ½æœ‰ 1 å¼ èƒŒæ™¯å›¾ï¼ˆä¸Šä¼ æ–°å›¾ä¼šè‡ªåŠ¨åˆ é™¤æ—§å›¾ï¼‰
- ä¸Šä¼ æˆåŠŸåä¼šè‡ªåŠ¨æ›´æ–°ç”¨æˆ·çš„ç¼–è¾‘å™¨è®¾ç½®

---

## 7. åˆ é™¤ç¼–è¾‘å™¨èƒŒæ™¯å›¾ ğŸ†•

### æ¥å£ä¿¡æ¯

- **è·¯å¾„**: `DELETE /editor-settings/background`
- **æƒé™**: `editor-settings:update`ï¼ˆæ™®é€šç”¨æˆ·ï¼‰
- **æè¿°**: åˆ é™¤å½“å‰ç”¨æˆ·çš„ç¼–è¾‘å™¨èƒŒæ™¯å›¾

### å“åº”ç¤ºä¾‹

```json
{
  "message": "èƒŒæ™¯å›¾å·²åˆ é™¤"
}
```

---

## é»˜è®¤é…ç½®è¯´æ˜

### é»˜è®¤å€¼

| é…ç½®é¡¹       | é»˜è®¤å€¼                                           |
| ------------ | ------------------------------------------------ |
| å­—ä½“         | Microsoft YaHei, PingFang SC, SimSun, sans-serif |
| å­—ä½“å¤§å°     | 16px                                             |
| è¡Œè·         | 1.8                                              |
| ä¸»é¢˜         | autoï¼ˆè·Ÿéšç³»ç»Ÿï¼‰                                 |
| æ®µé¦–ç©ºæ ¼     | 2 ä¸ªå…¨è§’ç©ºæ ¼                                     |
| æ®µé—´ç©ºè¡Œ     | 1 è¡Œ                                             |
| è‡ªåŠ¨ä¿å­˜     | å¼€å¯                                             |
| è‡ªåŠ¨ä¿å­˜é—´éš” | 30 ç§’                                            |
| å­—æ•°ç»Ÿè®¡     | æ˜¾ç¤º                                             |
| èƒŒæ™¯é¢œè‰²     | æ— ï¼ˆnullï¼‰                                       |
| èƒŒæ™¯å›¾ç‰‡     | æ— ï¼ˆnullï¼‰                                       |

### ä¸»é¢˜è¯´æ˜

- `light`: æµ…è‰²ä¸»é¢˜
- `dark`: æ·±è‰²ä¸»é¢˜
- `auto`: è·Ÿéšç³»ç»Ÿä¸»é¢˜

---

## é”™è¯¯ç 

| é”™è¯¯ç  | è¯´æ˜                                 |
| ------ | ------------------------------------ |
| 400    | è¯·æ±‚å‚æ•°æ— æ•ˆï¼ˆè¶…å‡ºèŒƒå›´ã€æ ¼å¼é”™è¯¯ç­‰ï¼‰ |
| 401    | æœªç™»å½•æˆ– Token å¤±æ•ˆ                  |
| 404    | ç¼–è¾‘å™¨è®¾ç½®ä¸å­˜åœ¨ï¼ˆåˆ é™¤/æ›´æ–°æ—¶ï¼‰      |
| 500    | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯                       |

---

## ä½¿ç”¨ç¤ºä¾‹

### åœºæ™¯ 1ï¼šé¦–æ¬¡è¿›å…¥ç¼–è¾‘å™¨

```javascript
// 1. è·å–ç¼–è¾‘å™¨è®¾ç½®
const response = await fetch("/api/v1/editor-settings", {
  headers: {
    Authorization: "Bearer YOUR_TOKEN",
  },
});
const settings = await response.json();

// 2. åº”ç”¨è®¾ç½®åˆ°ç¼–è¾‘å™¨
editor.setFontSize(settings.fontSize);
editor.setTheme(settings.theme);
editor.setLineHeight(settings.lineHeight);
```

### åœºæ™¯ 2ï¼šç”¨æˆ·ä¿®æ”¹è®¾ç½®

```javascript
// ç”¨æˆ·ä¿®æ”¹å­—ä½“å¤§å°å’Œä¸»é¢˜
const response = await fetch("/api/v1/editor-settings", {
  method: "PUT",
  headers: {
    Authorization: "Bearer YOUR_TOKEN",
    "Content-Type": "application/json",
  },
  body: JSON.stringify({
    fontSize: 20,
    theme: "dark",
  }),
});
const updatedSettings = await response.json();
```

### åœºæ™¯ 3ï¼šé‡ç½®è®¾ç½®

```javascript
// ç”¨æˆ·ç‚¹å‡»"æ¢å¤é»˜è®¤è®¾ç½®"
const response = await fetch("/api/v1/editor-settings/reset", {
  method: "POST",
  headers: {
    Authorization: "Bearer YOUR_TOKEN",
  },
});
const defaultSettings = await response.json();
```

---

## æ³¨æ„äº‹é¡¹

1. **ç”¨æˆ·éš”ç¦»**ï¼šæ¯ä¸ªç”¨æˆ·åªèƒ½æŸ¥çœ‹å’Œä¿®æ”¹è‡ªå·±çš„ç¼–è¾‘å™¨è®¾ç½®
2. **é»˜è®¤é…ç½®**ï¼šé¦–æ¬¡è·å–è®¾ç½®æ—¶ï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰é…ç½®ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨åˆ›å»ºé»˜è®¤é…ç½®
3. **å‚æ•°éªŒè¯**ï¼šæ‰€æœ‰æ•°å€¼å‚æ•°éƒ½æœ‰èŒƒå›´é™åˆ¶ï¼Œè¶…å‡ºèŒƒå›´ä¼šè¿”å› 400 é”™è¯¯
4. **è‡ªåŠ¨ä¿å­˜**ï¼šç¼–è¾‘å™¨åº”æ ¹æ® `autoSave` å’Œ `autoSaveInterval` è®¾ç½®å®ç°è‡ªåŠ¨ä¿å­˜åŠŸèƒ½
5. **ä¸»é¢˜åŒæ­¥**ï¼š`auto` ä¸»é¢˜åº”ç›‘å¬ç³»ç»Ÿä¸»é¢˜å˜åŒ–å¹¶è‡ªåŠ¨åˆ‡æ¢

---

## ç‰ˆæœ¬å†å²

| ç‰ˆæœ¬ | æ—¥æœŸ       | è¯´æ˜                             |
| ---- | ---------- | -------------------------------- |
| v1.2 | 2025-11-02 | æ–°å¢èƒŒæ™¯é¢œè‰²å’ŒèƒŒæ™¯å›¾åŠŸèƒ½         |
| v1.1 | 2025-11-02 | æ–°å¢ç”¨æˆ·ä¸Šä¼ å­—ä½“åŠŸèƒ½             |
| v1.0 | 2025-11-02 | åˆå§‹ç‰ˆæœ¬ï¼Œæ”¯æŒåŸºç¡€ç¼–è¾‘å™¨è®¾ç½®åŠŸèƒ½ |
