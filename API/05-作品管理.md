# 05 - ä½œå“ç®¡ç†æ¨¡å— API

> **æ¨¡å—è¯´æ˜**: ä½œå“ç®¡ç†æ¨¡å—ï¼ŒåŒ…å«ä½œå“ã€åˆ†å·ã€ç« èŠ‚ã€å†å²ç‰ˆæœ¬ã€äººç‰©å¡ã€ä¸–ç•Œè§‚ã€å¤‡å¿˜å½•çš„å®Œæ•´CRUDåŠŸèƒ½
> 
> **åŸºç¡€è·¯å¾„**: `/api/v1`
> 
> **è®¤è¯æ–¹å¼**: Bearer Token (JWT)
> 
> **æ›´æ–°æ—¶é—´**: 2025-10-18

---

## ğŸ“š ç›®å½•

- [æ–‡ä»¶ä¸Šä¼  (Upload)](#æ–‡ä»¶ä¸Šä¼ -upload)
- [ä½œå“ç®¡ç† (Novels)](#ä½œå“ç®¡ç†-novels)
- [åˆ†å·ç®¡ç† (Volumes)](#åˆ†å·ç®¡ç†-volumes)
- [ç« èŠ‚ç®¡ç† (Chapters)](#ç« èŠ‚ç®¡ç†-chapters)
- [ç« èŠ‚å†å²ç‰ˆæœ¬ (Chapter Versions)](#ç« èŠ‚å†å²ç‰ˆæœ¬-chapter-versions)
- [äººç‰©å¡ç®¡ç† (Characters)](#äººç‰©å¡ç®¡ç†-characters)
- [ä¸–ç•Œè§‚ç®¡ç† (World Settings)](#ä¸–ç•Œè§‚ç®¡ç†-world-settings)
- [å¤‡å¿˜å½•ç®¡ç† (Memos)](#å¤‡å¿˜å½•ç®¡ç†-memos)

---

## æ–‡ä»¶ä¸Šä¼  (Upload)

### ä¸Šä¼ ä½œå“å°é¢

**æ¥å£**: `POST /novels/upload/cover`

**æƒé™**: éœ€è¦ç™»å½•

**Content-Type**: `multipart/form-data`

**è¯·æ±‚å‚æ•°**:
| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| file | File | æ˜¯ | å°é¢å›¾ç‰‡æ–‡ä»¶ |

**æ–‡ä»¶è¦æ±‚**:
- æ”¯æŒæ ¼å¼ï¼šJPG, JPEG, PNG, WebP
- æ–‡ä»¶å¤§å°ï¼šæœ€å¤§ 5MB
- å»ºè®®å°ºå¯¸ï¼šå®½é«˜æ¯” 3:4

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "code": 200,
  "message": "ä¸Šä¼ æˆåŠŸ",
  "data": {
    "url": "/uploads/covers/cover-1697616000000-123456789.jpg",
    "filename": "cover-1697616000000-123456789.jpg",
    "originalName": "my-cover.jpg",
    "size": 245678,
    "mimeType": "image/jpeg"
  },
  "timestamp": 1697616000000
}
```

**ä½¿ç”¨è¯´æ˜**:
1. **ä¸Šä¼ åè·å–URL**ï¼šä¸Šä¼ æˆåŠŸåè¿”å›çš„ `url` å¯ç”¨äºåˆ›å»º/æ›´æ–°ä½œå“çš„ `coverImage` å­—æ®µ
2. **è®¿é—®å°é¢**ï¼š`http://localhost:3000/uploads/covers/filename.jpg`
3. **æ”¯æŒå¤–éƒ¨URL**ï¼šä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨å¤–éƒ¨å›¾ç‰‡URLï¼ˆå¦‚CDNï¼‰ï¼Œä¸ä¸€å®šè¦ä¸Šä¼ åˆ°æœåŠ¡å™¨
4. **å›¾ç‰‡åŠ è½½å¤±è´¥**ï¼šå‰ç«¯ä¼šè‡ªåŠ¨å¤„ç†URLå¤±æ•ˆçš„æƒ…å†µï¼Œæ˜¾ç¤ºé»˜è®¤å°é¢

**é”™è¯¯å“åº”**:
```json
{
  "success": false,
  "code": 400,
  "message": "åªæ”¯æŒ jpg, jpeg, png, webp æ ¼å¼çš„å›¾ç‰‡",
  "timestamp": 1697616000000
}
```

---

## ä½œå“ç®¡ç† (Novels)

### 1. åˆ›å»ºä½œå“

**æ¥å£**: `POST /novels`

**æƒé™**: éœ€è¦ç™»å½•

**è¯·æ±‚ä½“**:
```json
{
  "name": "æˆ‘çš„å°è¯´",
  "synopsis": "è¿™æ˜¯ä¸€éƒ¨ç²¾å½©çš„å°è¯´...",
  "genres": ["fantasy", "wuxia"],
  "form": "novel",
  "status": "ongoing",
  "targetWordsPerChapter": 2000,
  "coverImage": "https://example.com/cover.jpg"
}
```

**å­—æ®µè¯´æ˜**:
| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| name | string | æ˜¯ | ä½œå“åç§°ï¼Œæœ€å¤š200å­—ç¬¦ |
| synopsis | string | å¦ | ä½œå“ç®€ä»‹ |
| genres | array | å¦ | ä½œå“ç±»å‹æ•°ç»„ï¼ˆæ”¯æŒå¤šé€‰ï¼‰ï¼Œé»˜è®¤[]ï¼Œè§ä¸‹æ–¹ç±»å‹æšä¸¾ |
| form | string | å¦ | ä½œå“å½¢å¼ï¼šnovel/short_story/script/otherï¼Œé»˜è®¤novel |
| status | string | å¦ | çŠ¶æ€ï¼šongoing/completed/archived/pausedï¼Œé»˜è®¤ongoing |
| targetWordsPerChapter | number | å¦ | æ¯ç« ç›®æ ‡å­—æ•°ï¼Œé»˜è®¤2000 |
| coverImage | string | å¦ | å°é¢å›¾ç‰‡URL |

**ä½œå“ç±»å‹æšä¸¾** (genres):
- `fantasy` - ç„å¹»
- `traditional_fantasy` - ä¼ ç»Ÿç„å¹»
- `urban` - éƒ½å¸‚
- `history` - å†å²
- `fictional` - æ¶ç©º
- `mystery` - æ‚¬ç–‘
- `scifi` - ç§‘å¹»
- `sports` - ä½“è‚²
- `wuxia` - æ­¦ä¾ 
- `apocalypse` - æœ«æ—¥
- `fanfiction` - åŠ¨æ¼«è¡ç”Ÿ
- `film_tv` - å½±è§†
- `espionage` - è°æˆ˜

**ä½œå“å½¢å¼æšä¸¾** (form):
- `novel` - é•¿ç¯‡
- `short_story` - çŸ­ç¯‡
- `script` - å‰§æœ¬
- `other` - å…¶ä»–

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": {
    "id": 1,
    "userId": 1,
    "name": "æˆ‘çš„å°è¯´",
    "synopsis": "è¿™æ˜¯ä¸€éƒ¨ç²¾å½©çš„å°è¯´...",
    "genres": ["fantasy", "wuxia"],
    "form": "novel",
    "status": "ongoing",
    "totalWordCount": 0,
    "targetWordsPerChapter": 2000,
    "coverImage": "https://example.com/cover.jpg",
    "createdAt": "2025-10-18T12:00:00.000Z",
    "updatedAt": "2025-10-18T12:00:00.000Z"
  },
  "timestamp": 1697616000000
}
```

---

### 2. è·å–æˆ‘çš„ä½œå“åˆ—è¡¨

**æ¥å£**: `GET /novels`

**æƒé™**: éœ€è¦ç™»å½•

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": [
    {
      "id": 1,
      "name": "æˆ‘çš„å°è¯´",
      "synopsis": "è¿™æ˜¯ä¸€éƒ¨ç²¾å½©çš„å°è¯´...",
      "genres": ["fantasy", "wuxia"],
      "form": "novel",
      "status": "ongoing",
      "totalWordCount": 50000,
      "targetWordsPerChapter": 2000,
      "coverImage": "https://example.com/cover.jpg",
      "createdAt": "2025-10-18T12:00:00.000Z",
      "updatedAt": "2025-10-18T12:00:00.000Z"
    }
  ],
  "timestamp": 1697616000000
}
```

---

### 3. è·å–ä½œå“è¯¦æƒ…

**æ¥å£**: `GET /novels/:id`

**æƒé™**: éœ€è¦ç™»å½•ï¼Œä¸”åªèƒ½æŸ¥çœ‹è‡ªå·±çš„ä½œå“

**è·¯å¾„å‚æ•°**:
| å‚æ•° | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | number | ä½œå“ID |

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": {
    "id": 1,
    "name": "æˆ‘çš„å°è¯´",
    "synopsis": "è¿™æ˜¯ä¸€éƒ¨ç²¾å½©çš„å°è¯´...",
    "genres": ["fantasy", "wuxia"],
    "form": "novel",
    "status": "ongoing",
    "totalWordCount": 50000,
    "targetWordsPerChapter": 2000,
    "coverImage": "https://example.com/cover.jpg",
    "volumes": [],
    "characters": [],
    "worldSettings": [],
    "memos": [],
    "createdAt": "2025-10-18T12:00:00.000Z",
    "updatedAt": "2025-10-18T12:00:00.000Z"
  },
  "timestamp": 1697616000000
}
```

---

### 4. æ›´æ–°ä½œå“ä¿¡æ¯

**æ¥å£**: `PATCH /novels/:id`

**æƒé™**: éœ€è¦ç™»å½•ï¼Œä¸”åªèƒ½ä¿®æ”¹è‡ªå·±çš„ä½œå“

**è·¯å¾„å‚æ•°**:
| å‚æ•° | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | number | ä½œå“ID |

**è¯·æ±‚ä½“**: ä¸åˆ›å»ºä½œå“ç›¸åŒï¼Œæ‰€æœ‰å­—æ®µå‡ä¸ºå¯é€‰

**å“åº”ç¤ºä¾‹**: ä¸è·å–ä½œå“è¯¦æƒ…ç›¸åŒ

---

### 5. åˆ é™¤ä½œå“

**æ¥å£**: `DELETE /novels/:id`

**æƒé™**: éœ€è¦ç™»å½•ï¼Œä¸”åªèƒ½åˆ é™¤è‡ªå·±çš„ä½œå“

**è·¯å¾„å‚æ•°**:
| å‚æ•° | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | number | ä½œå“ID |

**è¯´æ˜**: è½¯åˆ é™¤ï¼Œä¸ä¼šçœŸæ­£åˆ é™¤æ•°æ®

---

## åˆ†å·ç®¡ç† (Volumes)

### 1. åˆ›å»ºåˆ†å·

**æ¥å£**: `POST /volumes?novelId={novelId}`

**æƒé™**: éœ€è¦ç™»å½•

**æŸ¥è¯¢å‚æ•°**:
| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| novelId | number | æ˜¯ | ä½œå“ID |

**è¯·æ±‚ä½“**:
```json
{
  "name": "ç¬¬ä¸€å·",
  "description": "æ•…äº‹çš„å¼€å§‹...",
  "order": 1
}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": {
    "id": 1,
    "novelId": 1,
    "name": "ç¬¬ä¸€å·",
    "description": "æ•…äº‹çš„å¼€å§‹...",
    "order": 1,
    "wordCount": 0,
    "createdAt": "2025-10-18T12:00:00.000Z",
    "updatedAt": "2025-10-18T12:00:00.000Z"
  },
  "timestamp": 1697616000000
}
```

---

### 2. è·å–ä½œå“çš„åˆ†å·åˆ—è¡¨

**æ¥å£**: `GET /volumes?novelId={novelId}`

**æƒé™**: éœ€è¦ç™»å½•

**æŸ¥è¯¢å‚æ•°**:
| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| novelId | number | æ˜¯ | ä½œå“ID |

---

### 3. è·å–åˆ†å·è¯¦æƒ…

**æ¥å£**: `GET /volumes/:id`

**æƒé™**: éœ€è¦ç™»å½•

---

### 4. æ›´æ–°åˆ†å·

**æ¥å£**: `PATCH /volumes/:id`

**æƒé™**: éœ€è¦ç™»å½•

---

### 5. åˆ é™¤åˆ†å·

**æ¥å£**: `DELETE /volumes/:id`

**æƒé™**: éœ€è¦ç™»å½•

---

## ç« èŠ‚ç®¡ç† (Chapters)

### 1. åˆ›å»ºç« èŠ‚

**æ¥å£**: `POST /chapters`

**æƒé™**: éœ€è¦ç™»å½•

**è¯·æ±‚ä½“**:
```json
{
  "volumeId": 1,
  "title": "ç¬¬ä¸€ç«  å¼€å§‹",
  "content": "ç« èŠ‚å†…å®¹...",
  "order": 1
}
```

**å­—æ®µè¯´æ˜**:
| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| volumeId | number | æ˜¯ | åˆ†å·ID |
| title | string | æ˜¯ | ç« èŠ‚æ ‡é¢˜ï¼Œæœ€å¤š200å­—ç¬¦ |
| content | string | æ˜¯ | ç« èŠ‚å†…å®¹ |
| order | number | å¦ | æ’åºé¡ºåº |

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": {
    "id": 1,
    "volumeId": 1,
    "title": "ç¬¬ä¸€ç«  å¼€å§‹",
    "content": "ç« èŠ‚å†…å®¹...",
    "order": 1,
    "wordCount": 1500,
    "createdAt": "2025-10-18T12:00:00.000Z",
    "updatedAt": "2025-10-18T12:00:00.000Z"
  },
  "timestamp": 1697616000000
}
```

**è¯´æ˜**: 
- åˆ›å»ºç« èŠ‚æ—¶ä¼šè‡ªåŠ¨è®¡ç®—å­—æ•°
- ä¼šè‡ªåŠ¨åˆ›å»ºåˆå§‹ç‰ˆæœ¬ï¼ˆç‰ˆæœ¬å·1ï¼‰

---

### 2. è·å–åˆ†å·çš„ç« èŠ‚åˆ—è¡¨

**æ¥å£**: `GET /chapters?volumeId={volumeId}`

**æƒé™**: éœ€è¦ç™»å½•

**æŸ¥è¯¢å‚æ•°**:
| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| volumeId | number | æ˜¯ | åˆ†å·ID |

---

### 3. è·å–ç« èŠ‚è¯¦æƒ…

**æ¥å£**: `GET /chapters/:id`

**æƒé™**: éœ€è¦ç™»å½•

---

### 4. æ›´æ–°ç« èŠ‚

**æ¥å£**: `PATCH /chapters/:id`

**æƒé™**: éœ€è¦ç™»å½•

**è¯·æ±‚ä½“**:
```json
{
  "title": "ç¬¬ä¸€ç«  å…¨æ–°å¼€å§‹",
  "content": "æ›´æ–°åçš„ç« èŠ‚å†…å®¹...",
  "order": 1
}
```

**è¯´æ˜**: 
- æ›´æ–°ç« èŠ‚æ—¶ä¼šè‡ªåŠ¨é‡æ–°è®¡ç®—å­—æ•°
- å¦‚æœè·ç¦»ä¸Šæ¬¡ä¿å­˜è¶…è¿‡1åˆ†é’Ÿï¼Œä¼šè‡ªåŠ¨åˆ›å»ºæ–°ç‰ˆæœ¬
- æœ€å¤šä¿ç•™10ä¸ªå†å²ç‰ˆæœ¬ï¼Œè¶…è¿‡ä¼šè‡ªåŠ¨æ¸…ç†æœ€æ—§çš„ç‰ˆæœ¬

---

### 5. åˆ é™¤ç« èŠ‚

**æ¥å£**: `DELETE /chapters/:id`

**æƒé™**: éœ€è¦ç™»å½•

---

## ç« èŠ‚å†å²ç‰ˆæœ¬ (Chapter Versions)

### 1. è·å–ç« èŠ‚çš„æ‰€æœ‰å†å²ç‰ˆæœ¬

**æ¥å£**: `GET /chapters/:id/versions`

**æƒé™**: éœ€è¦ç™»å½•

**è·¯å¾„å‚æ•°**:
| å‚æ•° | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | number | ç« èŠ‚ID |

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": [
    {
      "id": 10,
      "chapterId": 1,
      "version": 10,
      "title": "ç¬¬ä¸€ç«  å…¨æ–°å¼€å§‹",
      "content": "æœ€æ–°ç‰ˆæœ¬å†…å®¹...",
      "wordCount": 1600,
      "note": "è‡ªåŠ¨ä¿å­˜",
      "createdAt": "2025-10-18T12:10:00.000Z"
    },
    {
      "id": 9,
      "chapterId": 1,
      "version": 9,
      "title": "ç¬¬ä¸€ç«  å¼€å§‹",
      "content": "ä¸Šä¸€ç‰ˆæœ¬å†…å®¹...",
      "wordCount": 1500,
      "note": "è‡ªåŠ¨ä¿å­˜",
      "createdAt": "2025-10-18T12:09:00.000Z"
    }
  ],
  "timestamp": 1697616000000
}
```

**è¯´æ˜**: 
- æŒ‰ç‰ˆæœ¬å·é™åºæ’åˆ—ï¼ˆæœ€æ–°çš„åœ¨å‰ï¼‰
- æœ€å¤šè¿”å›10ä¸ªç‰ˆæœ¬

---

### 2. è·å–ç‰¹å®šå†å²ç‰ˆæœ¬

**æ¥å£**: `GET /chapters/:id/versions/:versionNumber`

**æƒé™**: éœ€è¦ç™»å½•

**è·¯å¾„å‚æ•°**:
| å‚æ•° | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | number | ç« èŠ‚ID |
| versionNumber | number | ç‰ˆæœ¬å· |

---

### 3. æ¢å¤åˆ°æŒ‡å®šå†å²ç‰ˆæœ¬

**æ¥å£**: `POST /chapters/:id/versions/:versionNumber/restore`

**æƒé™**: éœ€è¦ç™»å½•

**è·¯å¾„å‚æ•°**:
| å‚æ•° | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | number | ç« èŠ‚ID |
| versionNumber | number | è¦æ¢å¤åˆ°çš„ç‰ˆæœ¬å· |

**å“åº”ç¤ºä¾‹**: è¿”å›æ›´æ–°åçš„ç« èŠ‚ä¿¡æ¯

**è¯´æ˜**: 
- æ¢å¤å‰ä¼šå…ˆä¿å­˜å½“å‰å†…å®¹ä¸ºæ–°ç‰ˆæœ¬ï¼ˆæ ‡æ³¨ä¸º"æ¢å¤å‰çš„ç‰ˆæœ¬"ï¼‰
- æ¢å¤åä¼šå†åˆ›å»ºä¸€ä¸ªç‰ˆæœ¬ï¼ˆæ ‡æ³¨ä¸º"ä»ç‰ˆæœ¬Xæ¢å¤"ï¼‰

---

## äººç‰©å¡ç®¡ç† (Characters)

### 1. åˆ›å»ºäººç‰©å¡

**æ¥å£**: `POST /characters?novelId={novelId}`

**æƒé™**: éœ€è¦ç™»å½•

**æŸ¥è¯¢å‚æ•°**:
| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| novelId | number | æ˜¯ | ä½œå“ID |

**è¯·æ±‚ä½“**:
```json
{
  "name": "ä¸»è§’",
  "category": "ä¸»è¦äººç‰©",
  "fields": {
    "æ€§åˆ«": "ç”·",
    "å¹´é¾„": "25",
    "èŒä¸š": "å‰‘å®¢",
    "æ€§æ ¼": "å†·é™ã€æœæ–­",
    "å¤–è²Œ": "é»‘å‘é»‘çœ¸ï¼Œèº«æä¿®é•¿",
    "èƒ½åŠ›": "å‰‘æœ¯ç²¾æ¹›ï¼Œå†…åŠ›æ·±åš",
    "èƒŒæ™¯": "æ¥è‡ªæ±Ÿå—ä¸–å®¶..."
  },
  "order": 1
}
```

**å­—æ®µè¯´æ˜**:
| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| name | string | æ˜¯ | äººç‰©åç§°ï¼Œæœ€å¤š100å­—ç¬¦ |
| category | string | å¦ | åˆ†ç±»/åˆ†ç»„ï¼Œç±»ä¼¼æ–‡ä»¶å¤¹ |
| fields | object | å¦ | JSONæ ¼å¼çš„è‡ªå®šä¹‰å­—æ®µï¼Œå¯ä»¥ä»»æ„å®šä¹‰ |
| order | number | å¦ | æ’åºé¡ºåº |

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": {
    "id": 1,
    "novelId": 1,
    "name": "ä¸»è§’",
    "category": "ä¸»è¦äººç‰©",
    "fields": {
      "æ€§åˆ«": "ç”·",
      "å¹´é¾„": "25",
      "èŒä¸š": "å‰‘å®¢",
      "æ€§æ ¼": "å†·é™ã€æœæ–­",
      "å¤–è²Œ": "é»‘å‘é»‘çœ¸ï¼Œèº«æä¿®é•¿",
      "èƒ½åŠ›": "å‰‘æœ¯ç²¾æ¹›ï¼Œå†…åŠ›æ·±åš",
      "èƒŒæ™¯": "æ¥è‡ªæ±Ÿå—ä¸–å®¶..."
    },
    "order": 1,
    "createdAt": "2025-10-18T12:00:00.000Z",
    "updatedAt": "2025-10-18T12:00:00.000Z"
  },
  "timestamp": 1697616000000
}
```

**è¯´æ˜**: 
- `fields` å­—æ®µå®Œå…¨è‡ªå®šä¹‰ï¼Œå¯ä»¥æ ¹æ®éœ€è¦æ·»åŠ ä»»æ„å±æ€§
- æ”¯æŒä½¿ç”¨ `category` è¿›è¡Œåˆ†ç»„ç®¡ç†

---

### 2. è·å–ä½œå“çš„äººç‰©å¡åˆ—è¡¨

**æ¥å£**: `GET /characters?novelId={novelId}`

**æƒé™**: éœ€è¦ç™»å½•

**æŸ¥è¯¢å‚æ•°**:
| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| novelId | number | æ˜¯ | ä½œå“ID |

**è¯´æ˜**: æŒ‰åˆ†ç±»å’Œé¡ºåºæ’åºè¿”å›

---

### 3. è·å–äººç‰©å¡è¯¦æƒ…

**æ¥å£**: `GET /characters/:id`

**æƒé™**: éœ€è¦ç™»å½•

---

### 4. æ›´æ–°äººç‰©å¡

**æ¥å£**: `PATCH /characters/:id`

**æƒé™**: éœ€è¦ç™»å½•

---

### 5. åˆ é™¤äººç‰©å¡

**æ¥å£**: `DELETE /characters/:id`

**æƒé™**: éœ€è¦ç™»å½•

---

## ä¸–ç•Œè§‚ç®¡ç† (World Settings)

### 1. åˆ›å»ºä¸–ç•Œè§‚è®¾å®š

**æ¥å£**: `POST /world-settings?novelId={novelId}`

**æƒé™**: éœ€è¦ç™»å½•

**æŸ¥è¯¢å‚æ•°**:
| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| novelId | number | æ˜¯ | ä½œå“ID |

**è¯·æ±‚ä½“**:
```json
{
  "name": "ä¸œæµ·",
  "category": "åœ°ç†",
  "fields": {
    "ç±»å‹": "æµ·åŸŸ",
    "ä½ç½®": "å¤§é™†ä¸œéƒ¨",
    "ç‰¹ç‚¹": "æµ·åŸŸè¾½é˜”ï¼Œå¤šå²›å±¿",
    "èµ„æº": "çç ã€æµ·çµçŸ³",
    "åŠ¿åŠ›": "ä¸œæµ·é¾™å®«",
    "å†å²": "è‡ªå¤ä»¥æ¥ä¾¿æ˜¯..."
  },
  "order": 1
}
```

**å­—æ®µè¯´æ˜**: ä¸äººç‰©å¡ç±»ä¼¼ï¼Œæ”¯æŒå®Œå…¨è‡ªå®šä¹‰çš„ `fields` å­—æ®µ

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": {
    "id": 1,
    "novelId": 1,
    "name": "ä¸œæµ·",
    "category": "åœ°ç†",
    "fields": {
      "ç±»å‹": "æµ·åŸŸ",
      "ä½ç½®": "å¤§é™†ä¸œéƒ¨",
      "ç‰¹ç‚¹": "æµ·åŸŸè¾½é˜”ï¼Œå¤šå²›å±¿",
      "èµ„æº": "çç ã€æµ·çµçŸ³",
      "åŠ¿åŠ›": "ä¸œæµ·é¾™å®«",
      "å†å²": "è‡ªå¤ä»¥æ¥ä¾¿æ˜¯..."
    },
    "order": 1,
    "createdAt": "2025-10-18T12:00:00.000Z",
    "updatedAt": "2025-10-18T12:00:00.000Z"
  },
  "timestamp": 1697616000000
}
```

**å¸¸è§åˆ†ç±»ç¤ºä¾‹**:
- åœ°ç†ï¼šåœ°å½¢ã€åŸå¸‚ã€åŒºåŸŸ
- åŠ¿åŠ›ï¼šé—¨æ´¾ã€å®¶æ—ã€ç»„ç»‡
- ä½“ç³»ï¼šä¿®ç‚¼ä½“ç³»ã€ç­‰çº§åˆ’åˆ†
- æ³•åˆ™ï¼šä¸–ç•Œè§„åˆ™ã€é™åˆ¶
- ç‰©å“ï¼šç‰¹æ®Šç‰©å“ã€å®ç‰©
- å†å²ï¼šé‡è¦äº‹ä»¶ã€å¹´ä»£

---

### 2. è·å–ä½œå“çš„ä¸–ç•Œè§‚åˆ—è¡¨

**æ¥å£**: `GET /world-settings?novelId={novelId}`

**æƒé™**: éœ€è¦ç™»å½•

---

### 3. è·å–ä¸–ç•Œè§‚è¯¦æƒ…

**æ¥å£**: `GET /world-settings/:id`

**æƒé™**: éœ€è¦ç™»å½•

---

### 4. æ›´æ–°ä¸–ç•Œè§‚

**æ¥å£**: `PATCH /world-settings/:id`

**æƒé™**: éœ€è¦ç™»å½•

---

### 5. åˆ é™¤ä¸–ç•Œè§‚

**æ¥å£**: `DELETE /world-settings/:id`

**æƒé™**: éœ€è¦ç™»å½•

---

## å¤‡å¿˜å½•ç®¡ç† (Memos)

### 1. åˆ›å»ºå¤‡å¿˜å½•

**æ¥å£**: `POST /memos?novelId={novelId}`

**æƒé™**: éœ€è¦ç™»å½•

**æŸ¥è¯¢å‚æ•°**:
| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| novelId | number | æ˜¯ | ä½œå“ID |

**è¯·æ±‚ä½“**:
```json
{
  "title": "æƒ…èŠ‚æé†’",
  "content": "è®°å¾—åœ¨ç¬¬10ç« åŸ‹ä¸‹ä¼ç¬”...",
  "color": "blue",
  "isPinned": true,
  "reminderAt": "2025-10-20T10:00:00.000Z"
}
```

**å­—æ®µè¯´æ˜**:
| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| title | string | æ˜¯ | å¤‡å¿˜å½•æ ‡é¢˜ï¼Œæœ€å¤š200å­—ç¬¦ |
| content | string | æ˜¯ | å¤‡å¿˜å½•å†…å®¹ |
| color | string | å¦ | æ ‡ç­¾é¢œè‰² |
| isPinned | boolean | å¦ | æ˜¯å¦ç½®é¡¶ï¼Œé»˜è®¤false |
| reminderAt | string | å¦ | æé†’æ—¶é—´ï¼ˆISO 8601æ ¼å¼ï¼‰ |

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": {
    "id": 1,
    "novelId": 1,
    "title": "æƒ…èŠ‚æé†’",
    "content": "è®°å¾—åœ¨ç¬¬10ç« åŸ‹ä¸‹ä¼ç¬”...",
    "color": "blue",
    "isPinned": true,
    "reminderAt": "2025-10-20T10:00:00.000Z",
    "createdAt": "2025-10-18T12:00:00.000Z",
    "updatedAt": "2025-10-18T12:00:00.000Z"
  },
  "timestamp": 1697616000000
}
```

---

### 2. è·å–ä½œå“çš„å¤‡å¿˜å½•åˆ—è¡¨

**æ¥å£**: `GET /memos?novelId={novelId}`

**æƒé™**: éœ€è¦ç™»å½•

**æŸ¥è¯¢å‚æ•°**:
| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| novelId | number | æ˜¯ | ä½œå“ID |

**è¯´æ˜**: ç½®é¡¶çš„å¤‡å¿˜å½•ä¼šæ’åœ¨å‰é¢ï¼Œç„¶åæŒ‰åˆ›å»ºæ—¶é—´å€’åº

---

### 3. è·å–å¤‡å¿˜å½•è¯¦æƒ…

**æ¥å£**: `GET /memos/:id`

**æƒé™**: éœ€è¦ç™»å½•

---

### 4. æ›´æ–°å¤‡å¿˜å½•

**æ¥å£**: `PATCH /memos/:id`

**æƒé™**: éœ€è¦ç™»å½•

---

### 5. åˆ é™¤å¤‡å¿˜å½•

**æ¥å£**: `DELETE /memos/:id`

**æƒé™**: éœ€è¦ç™»å½•

---

## ğŸ“Œ é€šç”¨è¯´æ˜

### è®¤è¯

æ‰€æœ‰æ¥å£éƒ½éœ€è¦åœ¨è¯·æ±‚å¤´ä¸­æºå¸¦JWT Tokenï¼š

```
Authorization: Bearer {your_access_token}
```

### æƒé™éªŒè¯

- ç”¨æˆ·åªèƒ½æ“ä½œè‡ªå·±åˆ›å»ºçš„ä½œå“åŠå…¶ç›¸å…³æ•°æ®
- å°è¯•è®¿é—®ä»–äººçš„ä½œå“ä¼šè¿”å› 403 Forbidden

### é”™è¯¯å“åº”

æ‰€æœ‰é”™è¯¯å“åº”éƒ½éµå¾ªç»Ÿä¸€æ ¼å¼ï¼š

```json
{
  "success": false,
  "code": 400,
  "message": "é”™è¯¯ä¿¡æ¯",
  "data": {
    "error": "é”™è¯¯ç±»å‹",
    "details": null,
    "path": "/api/v1/novels",
    "method": "POST"
  },
  "timestamp": 1697616000000
}
```

### å¸¸è§é”™è¯¯ç 

| çŠ¶æ€ç  | è¯´æ˜ |
|--------|------|
| 400 | è¯·æ±‚å‚æ•°é”™è¯¯ |
| 401 | æœªè®¤è¯æˆ–Tokenè¿‡æœŸ |
| 403 | æ— æƒè®¿é—®è¯¥èµ„æº |
| 404 | èµ„æºä¸å­˜åœ¨ |
| 500 | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ |

---

## ğŸ¯ ä½¿ç”¨åœºæ™¯ç¤ºä¾‹

### åœºæ™¯1ï¼šåˆ›å»ºä¸€éƒ¨æ–°å°è¯´

1. åˆ›å»ºä½œå“ `POST /novels`
2. åˆ›å»ºç¬¬ä¸€å· `POST /volumes?novelId=1`
3. åˆ›å»ºç¬¬ä¸€ç«  `POST /chapters`
4. æ·»åŠ ä¸»è§’äººç‰©å¡ `POST /characters?novelId=1`
5. æ·»åŠ ä¸–ç•Œè§‚è®¾å®š `POST /world-settings?novelId=1`
6. æ·»åŠ åˆ›ä½œå¤‡å¿˜å½• `POST /memos?novelId=1`

### åœºæ™¯2ï¼šç¼–è¾‘ç« èŠ‚å¹¶ä½¿ç”¨ç‰ˆæœ¬æ§åˆ¶

1. è·å–ç« èŠ‚å†…å®¹ `GET /chapters/1`
2. æ›´æ–°ç« èŠ‚ï¼ˆä¼šè‡ªåŠ¨ä¿å­˜ç‰ˆæœ¬ï¼‰`PATCH /chapters/1`
3. æŸ¥çœ‹å†å²ç‰ˆæœ¬ `GET /chapters/1/versions`
4. å¦‚éœ€æ¢å¤æ—§ç‰ˆæœ¬ `POST /chapters/1/versions/5/restore`

### åœºæ™¯3ï¼šç®¡ç†äººç‰©å¡å’Œä¸–ç•Œè§‚

1. æŒ‰åˆ†ç±»åˆ›å»ºäººç‰©å¡ï¼š
   - ä¸»è¦äººç‰©ï¼šä¸»è§’ã€å¥³ä¸»ã€åæ´¾
   - é…è§’ï¼šå¸ˆçˆ¶ã€æœ‹å‹ã€æ•Œäºº
2. æŒ‰åˆ†ç±»åˆ›å»ºä¸–ç•Œè§‚ï¼š
   - åœ°ç†ï¼šä¸œæµ·ã€è¥¿åŸŸã€ä¸­å·
   - åŠ¿åŠ›ï¼šå„å¤§é—¨æ´¾
   - ä½“ç³»ï¼šä¿®ç‚¼ç­‰çº§

---

## ğŸ“Š æ•°æ®ç»Ÿè®¡

### å­—æ•°ç»Ÿè®¡æµç¨‹

```
ç« èŠ‚ (chapter.wordCount)
  â†“ ç´¯åŠ 
åˆ†å· (volume.wordCount)
  â†“ ç´¯åŠ 
ä½œå“ (novel.totalWordCount)
```

### ç‰ˆæœ¬ç®¡ç†è§„åˆ™

- **ä¿å­˜é¢‘ç‡**ï¼šæ¯åˆ†é’Ÿè‡ªåŠ¨ä¿å­˜ä¸€ä¸ªç‰ˆæœ¬
- **ç‰ˆæœ¬æ•°é‡**ï¼šæœ€å¤šä¿ç•™10ä¸ªç‰ˆæœ¬
- **æ¸…ç†ç­–ç•¥**ï¼šè¶…è¿‡10ä¸ªç‰ˆæœ¬æ—¶ï¼Œè‡ªåŠ¨åˆ é™¤æœ€æ—§çš„ç‰ˆæœ¬
- **ç‰¹æ®Šç‰ˆæœ¬**ï¼šæ‰‹åŠ¨æ¢å¤æ—¶ä¼šé¢å¤–åˆ›å»ºè¯´æ˜ç‰ˆæœ¬

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [é€šç”¨è§„èŒƒ](./99-é€šç”¨è§„èŒƒ.md)
- [è®¤è¯æ¨¡å—](./01-è®¤è¯æ¨¡å—.md)
- [é¡¹ç›®ç»“æ„](../backend/docs/PROJECT_STRUCTURE.md)
