# NotificationToast ä½¿ç”¨è¯´æ˜

## æ¦‚è¿°

`NotificationToast` æ˜¯ä¸€ä¸ªé€šç”¨çš„ç³»ç»Ÿé€šçŸ¥ç»„ä»¶ï¼Œç”¨äºæ˜¾ç¤ºæç¤ºè¯å®¡æ ¸ã€ç³»ç»Ÿæ¶ˆæ¯ç­‰å®æ—¶é€šçŸ¥ã€‚

## å·²é›†æˆ

âœ… å·²åœ¨ `App.tsx` ä¸­å…¨å±€é›†æˆï¼Œæ— éœ€é¢å¤–é…ç½®ï¼

```tsx
// App.tsx
import NotificationToast from "./components/notifications/NotificationToast";

<NotificationToast />  // è‡ªåŠ¨ç›‘å¬ notification:new æ¶ˆæ¯
```

## æ”¯æŒçš„é€šçŸ¥ç±»å‹

### 1. æç¤ºè¯ç”³è¯·é€šçŸ¥

**è§¦å‘**: ç”¨æˆ·æäº¤æç¤ºè¯ç”³è¯·

**æ˜¾ç¤º**: æç¤ºè¯ä½œè€…æ”¶åˆ°é€šçŸ¥

**æ ·å¼**: è“è‰²ï¼ˆinfoï¼‰

**è‡ªåŠ¨å…³é—­**: 8ç§’

### 2. ç”³è¯·é€šè¿‡é€šçŸ¥

**è§¦å‘**: ä½œè€…é€šè¿‡ç”³è¯·

**æ˜¾ç¤º**: ç”³è¯·è€…æ”¶åˆ°é€šçŸ¥

**æ ·å¼**: ç»¿è‰²ï¼ˆsuccessï¼‰

**è‡ªåŠ¨å…³é—­**: 10ç§’

### 3. ç”³è¯·æ‹’ç»é€šçŸ¥

**è§¦å‘**: ä½œè€…æ‹’ç»ç”³è¯·

**æ˜¾ç¤º**: ç”³è¯·è€…æ”¶åˆ°é€šçŸ¥

**æ ·å¼**: é»„è‰²ï¼ˆwarningï¼‰

**è‡ªåŠ¨å…³é—­**: ä¸è‡ªåŠ¨å…³é—­ï¼ˆéœ€æ‰‹åŠ¨å…³é—­ï¼‰

## ç‰¹æ€§

âœ… **è‡ªåŠ¨ç›‘å¬**: è‡ªåŠ¨è®¢é˜… `notification:new` WebSocketæ¶ˆæ¯

âœ… **æ™ºèƒ½æ˜¾ç¤º**: æ ¹æ®é€šçŸ¥çº§åˆ«æ˜¾ç¤ºä¸åŒé¢œè‰²å’Œå›¾æ ‡

âœ… **æ“ä½œæŒ‰é’®**: æ”¯æŒç‚¹å‡»è·³è½¬ï¼ˆå¦‚"æŸ¥çœ‹ç”³è¯·"ã€"ç«‹å³ä½¿ç”¨"ï¼‰

âœ… **å®¡æ ¸å¤‡æ³¨**: æ˜¾ç¤ºå®¡æ ¸é€šè¿‡/æ‹’ç»çš„å¤‡æ³¨ä¿¡æ¯

âœ… **è‡ªåŠ¨å…³é—­**: 
- æˆåŠŸæ¶ˆæ¯ï¼ˆé€šè¿‡ï¼‰ï¼š10ç§’åè‡ªåŠ¨å…³é—­
- æ™®é€šæ¶ˆæ¯ï¼ˆç”³è¯·ï¼‰ï¼š8ç§’åè‡ªåŠ¨å…³é—­
- è­¦å‘Š/é”™è¯¯æ¶ˆæ¯ï¼ˆæ‹’ç»ï¼‰ï¼šä¸è‡ªåŠ¨å…³é—­ï¼Œéœ€æ‰‹åŠ¨å…³é—­

âœ… **è¿›åº¦æ¡**: è‡ªåŠ¨å…³é—­æ—¶æ˜¾ç¤ºå€’è®¡æ—¶è¿›åº¦æ¡

âœ… **é˜²é‡å¤**: è‡ªåŠ¨è¿‡æ»¤å·²å…³é—­çš„é€šçŸ¥

## æ¶ˆæ¯æ ¼å¼

åç«¯æ¨é€çš„æ¶ˆæ¯æ ¼å¼ï¼š

```json
{
  "type": "notification:new",
  "data": {
    "id": "prompt-approval-123",
    "title": "æç¤ºè¯ç”³è¯·å·²é€šè¿‡",
    "content": "æ‚¨ç”³è¯·çš„æç¤ºè¯ã€ŒAIå†™ä½œåŠ©æ‰‹ã€å·²é€šè¿‡å®¡æ ¸ï¼Œç°åœ¨å¯ä»¥ä½¿ç”¨äº†ï¼",
    "category": "prompt-approval",
    "level": "success",
    "action": {
      "text": "ç«‹å³ä½¿ç”¨",
      "url": "/dashboard/prompts/456"
    },
    "extra": {
      "reviewNote": "æ¬¢è¿ä½¿ç”¨ï¼Œæœ‰é—®é¢˜éšæ—¶è”ç³»"
    },
    "createdAt": "2024-01-26T11:00:00.000Z"
  },
  "timestamp": 1706275200000
}
```

## æ ·å¼å’Œä½ç½®

- **ä½ç½®**: å³ä¸Šè§’ï¼ˆ`top-20 right-4`ï¼‰ï¼Œåœ¨å…¬å‘ŠToastä¸‹æ–¹
- **å®½åº¦**: æœ€å¤§ `max-w-md`
- **å±‚çº§**: `z-index: 9998`ï¼ˆä½äºå…¬å‘ŠToastçš„9999ï¼‰
- **åŠ¨ç”»**: ä»å³ä¾§æ»‘å…¥

## çº§åˆ«å’Œé¢œè‰²

| çº§åˆ« | é¢œè‰² | å›¾æ ‡ | ç”¨é€” |
|------|------|------|------|
| `info` | è“è‰² | â„¹ï¸ | æ–°ç”³è¯·ã€ä¸€èˆ¬ä¿¡æ¯ |
| `success` | ç»¿è‰² | âœ… | å®¡æ ¸é€šè¿‡ã€æˆåŠŸæ¶ˆæ¯ |
| `warning` | é»„è‰² | âš ï¸ | å®¡æ ¸æ‹’ç»ã€è­¦å‘Šæ¶ˆæ¯ |
| `error` | çº¢è‰² | âŒ | é”™è¯¯æ¶ˆæ¯ |
| é»˜è®¤ | ç°è‰² | ğŸ”” | å…¶ä»–é€šçŸ¥ |

## æµ‹è¯•é€šçŸ¥

### æµè§ˆå™¨æ§åˆ¶å°æµ‹è¯•

```javascript
// æ¨¡æ‹Ÿç”³è¯·é€šè¿‡é€šçŸ¥
wsService.handleMessage({
  type: 'notification:new',
  data: {
    id: 'test-approval-1',
    title: 'æç¤ºè¯ç”³è¯·å·²é€šè¿‡',
    content: 'æ‚¨ç”³è¯·çš„æç¤ºè¯ã€Œæµ‹è¯•æç¤ºè¯ã€å·²é€šè¿‡å®¡æ ¸ï¼',
    category: 'prompt-approval',
    level: 'success',
    action: {
      text: 'ç«‹å³ä½¿ç”¨',
      url: '/dashboard/prompts/1'
    },
    extra: {
      reviewNote: 'æ¬¢è¿ä½¿ç”¨ï¼Œæµ‹è¯•å¤‡æ³¨'
    },
    createdAt: new Date()
  },
  timestamp: Date.now()
});

// æ¨¡æ‹Ÿç”³è¯·æ‹’ç»é€šçŸ¥
wsService.handleMessage({
  type: 'notification:new',
  data: {
    id: 'test-rejection-1',
    title: 'æç¤ºè¯ç”³è¯·å·²æ‹’ç»',
    content: 'å¾ˆæŠ±æ­‰ï¼Œæ‚¨ç”³è¯·çš„æç¤ºè¯ã€Œæµ‹è¯•æç¤ºè¯ã€æœªé€šè¿‡å®¡æ ¸',
    category: 'prompt-rejection',
    level: 'warning',
    extra: {
      reviewNote: 'æš‚ä¸å¯¹å¤–å¼€æ”¾'
    },
    createdAt: new Date()
  },
  timestamp: Date.now()
});

// æ¨¡æ‹Ÿæ–°ç”³è¯·é€šçŸ¥ï¼ˆä½œè€…è§†è§’ï¼‰
wsService.handleMessage({
  type: 'notification:new',
  data: {
    id: 'test-application-1',
    title: 'æ”¶åˆ°æ–°çš„æç¤ºè¯ç”³è¯·',
    content: 'æœ‰ç”¨æˆ·ç”³è¯·ä½¿ç”¨æ‚¨çš„æç¤ºè¯ã€Œæµ‹è¯•æç¤ºè¯ã€',
    category: 'prompt-application',
    level: 'info',
    action: {
      text: 'æŸ¥çœ‹ç”³è¯·',
      url: '/dashboard/prompts/my-prompts?tab=applications'
    },
    createdAt: new Date()
  },
  timestamp: Date.now()
});
```

## æ‰©å±•

å¦‚æœéœ€è¦æ·»åŠ å…¶ä»–ç±»å‹çš„é€šçŸ¥ï¼Œåªéœ€åç«¯æ¨é€ `notification:new` æ¶ˆæ¯å³å¯ï¼Œç»„ä»¶ä¼šè‡ªåŠ¨å¤„ç†ã€‚

### æ·»åŠ è‡ªå®šä¹‰é€šçŸ¥ç±»åˆ«

```typescript
// backend
const message: WsMessage = {
  type: WsMessageType.NOTIFICATION_NEW,
  data: {
    id: `custom-${Date.now()}`,
    title: 'è‡ªå®šä¹‰é€šçŸ¥',
    content: 'è¿™æ˜¯ä¸€æ¡è‡ªå®šä¹‰é€šçŸ¥',
    category: 'custom-category',
    level: 'info',
    action: {
      text: 'æŸ¥çœ‹è¯¦æƒ…',
      url: '/custom-page'
    },
    createdAt: new Date(),
  },
  timestamp: Date.now(),
};

this.wsGateway.sendToUser(userId, message);
```

å‰ç«¯ä¼šè‡ªåŠ¨æ˜¾ç¤ºï¼Œæ— éœ€ä¿®æ”¹ä»£ç ï¼

## æ•…éšœæ’æŸ¥

### é—®é¢˜1: æ”¶ä¸åˆ°é€šçŸ¥

**æ£€æŸ¥**:
1. WebSocketæ˜¯å¦è¿æ¥ï¼šæ§åˆ¶å°æŸ¥çœ‹è¿æ¥çŠ¶æ€
2. æ˜¯å¦ç™»å½•ï¼šåªæœ‰ç™»å½•ç”¨æˆ·æ‰èƒ½æ”¶åˆ°é€šçŸ¥
3. åç«¯æ—¥å¿—ï¼šæŸ¥çœ‹æ˜¯å¦æˆåŠŸæ¨é€

```javascript
// æµè§ˆå™¨æ§åˆ¶å°
console.log('WebSocketè¿æ¥:', wsService.isConnected);
console.log('å½“å‰ç”¨æˆ·:', localStorage.getItem('user'));
```

### é—®é¢˜2: é€šçŸ¥æ˜¾ç¤ºä½ç½®é”™è¯¯

æ£€æŸ¥CSS `z-index` å’Œ `position` æ˜¯å¦è¢«å…¶ä»–å…ƒç´ è¦†ç›–ã€‚

### é—®é¢˜3: é€šçŸ¥ä¸è‡ªåŠ¨å…³é—­

æŸäº›é€šçŸ¥ï¼ˆæ‹’ç»ã€é”™è¯¯ï¼‰è®¾è®¡ä¸ºä¸è‡ªåŠ¨å…³é—­ï¼Œéœ€è¦ç”¨æˆ·æ‰‹åŠ¨å…³é—­ã€‚

## ç›¸å…³æ–‡æ¡£

- [æç¤ºè¯é€šçŸ¥æŒ‡å—](../../backend/src/prompts/NOTIFICATION_GUIDE.md)
- [WebSocketä½¿ç”¨æŒ‡å—](../services/WEBSOCKET_GUIDE.md)

